{#% render "AppBundle:App:checkAuth" %#}
{% extends 'AppBundle::page.html.twig' %}

{% block titre %}Bienvenue sur {{app_name|raw}} {% endblock %}
{% block body %}
{#{ app.session.flashbag.set('page_flash',[{ message: "MESSAGE STATIQUE issue de 'index.html.twig'...", type : "info" , start:false, stop:false}]) }#}

{%if app.session.get("curYear","") == "" %}
  {{ app.session.set("curYear",app.session.get("univYear")) }}
{%endif%}

{%set feminin=((app.session.get("supannCivilite","")=="Mme")?1:0) %}
<p class="block block-views ">{{app_welcome|raw}}</p>

 <!--[if lte IE 8]> 
 <br>
 <div class="ui-state-error ui-corner-all" style="padding:15px;">
  <img src="{{ asset('bundles/app/images/ico/48/terre.png') }}" align="absmiddle" />&nbsp;
   Attention votre navigateur semble être obsolète et risque donc de poser des problèmes de compatibilité...</br>
   Pour plus de sécurité veuillez vous connecter avec Mozilia FireFox...</br>
   ou du moins avec une version d'Internet Explorer de 9.0 ou plus récente (version 11 conseillée)
 </div>
 <br>
 <![endif]-->
 
<center>
  <div class="ui-corner-all ui-state-active TabInfos" style="padding: 10px;color: gray; max-width: 70%;">
    {%if (app.security.token.authenticated==true) and  (app.security.token.user!="anon.")  %} 
      </br><img src= "{{ asset('bundles/app/images/ico/32/'~((feminin==1)?"woman":"men")~'.png') }}" align="absmiddle" />&nbsp;{{ app.session.get('displayName') }} ({{app.session.get('amuMail')}})</br>
      {%if is_granted("ROLE_AUTHENTIFIED") and  is_expr_granted("hasAnyRole('ROLE_ADMIN','ROLE_SUPER_ADMIN')")  %}
        </br><img src= "{{ asset('bundles/app/images/ico/32/admin.png') }}" align="absmiddle" />&nbsp;Vous &ecirc;tes Administrateur de l'applications...
      {%elseif is_granted("ROLE_AUTHENTIFIED") and  is_granted("ROLE_MANAGER")  %}
        </br><img src= "{{ asset('bundles/app/images/ico/32/manager.png') }}" align="absmiddle" />&nbsp;Vous &ecirc;tes un "Manager" de l'applications...
      {%elseif is_granted("ROLE_AUTHENTIFIED") and  is_granted("ROLE_VIEWER")  %}
        </br><img src= "{{ asset('bundles/app/images/ico/32/users.png') }}" align="absmiddle" /><img src= "{{ asset('bundles/app/images/ico/32/view-page.png') }}" align="absmiddle" />&nbsp;Vous avez le droit de "Visualiser" certaines informations de l'applications...
        {%if  is_granted("ROLE_MODIFIER") %}
          </br><img src= "{{ asset('bundles/app/images/ico/32/users.png') }}" align="absmiddle" /><img src= "{{ asset('bundles/app/images/ico/32/modif.png') }}" align="absmiddle" />&nbsp;Vous avez aussi le droit de "Modifier" certaines informations de l'applications...
        {%endif%}
      {%elseif is_granted("ROLE_AUTHENTIFIED") and  is_granted("ROLE_MODIFIER")  %}
        </br><img src= "{{ asset('bundles/app/images/ico/32/user.png') }}" align="absmiddle" /><img src= "{{ asset('bundles/app/images/ico/32/modif.png') }}" align="absmiddle" />&nbsp;Vous avez le droit de "Modifier" certaines informations de l'applications...
      {#  
      {%elseif (app.security.token.authenticated==true) and is_granted("ROLE_AUTHENTIFIED") and  is_granted("ROLE_APPUSER")  %}
        </br>&nbsp;&nbsp;<img src= "{{ asset('bundles/app/images/ico/16/valid.png') }}" align="absmiddle" />&nbsp;Vous avez bien &eacute;t&eacute; reconnu{{ (feminin==1)?"e":""}} comme un{{ (feminin==1)?"e":""}} &eacute;tudiant{{ (feminin==1)?"e":""}} et donc...
        </br><br>Informations pour ce ROLE_APPUSER...
       #}
      {%endif%}
    {%else%}
      </br><img src= "{{ asset('bundles/app/images/ico/32/lock.png') }}" align="absmiddle" />&nbsp;Accès anonyme </br>
    {%endif%}
  </div>
</center>

{%if (app.security.token.authenticated==true) and is_granted("ROLE_AUTHENTIFIED") and  is_expr_granted("hasAnyRole('ROLE_ADMIN','ROLE_SUPER_ADMIN','ROLE_MANAGER')")  %}
<br><div class="ui-state-error ui-corner-all" style="padding:10px;"><b>Informations sp&eacute;ciales...</b><small><br>Elles ne seront affich&eacute;s que pour les 'ROLE_ADMIN','ROLE_SUPER_ADMIN','ROLE_MANAGER'</div>
{%endif%}
<br>
<div class="ui-state-active ui-corner-all" style="padding:10px;"><b>Autres informations globales... (ind&eacute;pendantes des ROLES)</b><small><br><br><br></small></div>
{% endblock %}